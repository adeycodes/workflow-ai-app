<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Builder - WorkflowAI</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* N8N iframe styles */
        .n8n-container {
            position: fixed;
            top: 60px;
            /* Height of your header */
            left: 0;
            right: 0;
            bottom: 0;
            background: #fff;
            z-index: 100;
            display: none;
            /* Hidden by default */
            flex-direction: column;
        }

        .n8n-toolbar {
            background: #f8f9fa;
            padding: 10px 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .n8n-iframe-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .n8n-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .n8n-loading {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        .toolbar {
            position: fixed;
            top: 70px;
            right: 20px;
            z-index: 101;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 10px;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .condition-nodes i {
            color: var(--warning);
        }

        .data-nodes i {
            color: var(--secondary);
        }

        .workflow-tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-200);
            margin-bottom: var(--spacing-lg);
        }

        .workflow-tab {
            padding: var(--spacing-md) var(--spacing-lg);
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray-600);
            transition: var(--transition);
            border-bottom: 2px solid transparent;
        }

        .workflow-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .workflow-tab:hover {
            color: var(--primary);
        }

        .execution-logs {
            background: var(--darker);
            color: var(--light);
            border-radius: var(--border-radius);
            padding: var(--spacing-lg);
            font-family: 'Courier New', monospace;
            font-size: var(--font-size-sm);
            max-height: 200px;
            overflow-y: auto;
        }

        .log-entry {
            margin-bottom: var(--spacing-sm);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .log-timestamp {
            color: var(--gray-400);
        }

        .log-success {
            color: var(--success);
        }

        .log-error {
            color: var(--danger);
        }

        .log-warning {
            color: var(--warning);
        }

        .workflow-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .workflow-stat {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-lg);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-value {
            font-size: var(--font-size-2xl);
            font-weight: 700;
            color: var(--primary);
            margin-bottom: var(--spacing-sm);
        }

        .stat-label {
            color: var(--gray-600);
            font-size: var(--font-size-sm);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .integration-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: var(--spacing-md);
            margin-top: var(--spacing-md);
        }

        .integration-card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .integration-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .integration-card img {
            width: 32px;
            height: 32px;
            margin-bottom: var(--spacing-sm);
        }

        .integration-card span {
            font-size: var(--font-size-xs);
            color: var(--gray-700);
            font-weight: 500;
        }

        .workflow-version {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
        }

        .version-badge {
            background: var(--primary);
            color: white;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius-full);
            font-size: var(--font-size-xs);
            font-weight: 600;
        }

        .minimap {
            position: absolute;
            top: var(--spacing-lg);
            right: var(--spacing-lg);
            width: 200px;
            height: 150px;
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid var(--gray-300);
            border-radius: var(--border-radius);
            backdrop-filter: blur(5px);
        }

        .zoom-controls {
            position: absolute;
            bottom: var(--spacing-lg);
            right: var(--spacing-lg);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .zoom-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius);
            border: 1px solid var(--gray-300);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .zoom-btn:hover {
            background: white;
            border-color: var(--primary);
            color: var(--primary);
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header>
        <div class="container navbar">
            <a href="/" class="navbar-brand">
                <i class="fas fa-robot"></i>
                WorkflowAI
            </a>
            <ul class="nav-links">
                <li><a href="/dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
                <li><a href="/templates.html"><i class="fas fa-th-large"></i> Templates</a></li>
                <li><a href="/builder.html" style="color: var(--primary);"><i class="fas fa-project-diagram"></i>
                        Builder</a></li>
                <li><a href="/settings.html"><i class="fas fa-cog"></i> Settings</a></li>
                <li><a href="#" id="logoutBtn" class="btn btn-outline"><i class="fas fa-sign-out-alt"></i> Logout</a>
                </li>
            </ul>
        </div>
    </header>

    <!-- Builder Content -->
    <section style="padding: var(--spacing-lg) 0; flex: 1;">
        <div class="container">
            <div class="dashboard-header">
                <div>
                    <div class="workflow-version">
                        <h1>Workflow Builder</h1>
                        <div class="version-badge">v1.0</div>
                        <span class="badge badge-success">BETA</span>
                    </div>
                    <p class="mb-0" style="color: var(--gray-600);">Design and configure your automation workflow with
                        visual drag-and-drop interface</p>
                </div>
                <div class="d-flex gap-md">
                    <button class="btn btn-ghost" id="previewBtn">
                        <i class="fas fa-eye"></i> Preview
                    </button>
                    <button class="btn btn-outline" id="testBtn">
                        <i class="fas fa-play"></i> Test Workflow
                    </button>
                    <button class="btn btn-primary" id="saveBtn">
                        <i class="fas fa-save"></i> Save Workflow
                    </button>
                </div>
            </div>

            <!-- Workflow Statistics -->
            <div class="workflow-stats">
                <div class="workflow-stat">
                    <div class="stat-value">5</div>
                    <div class="stat-label">Nodes</div>
                </div>
                <div class="workflow-stat">
                    <div class="stat-value">3</div>
                    <div class="stat-label">Connections</div>
                </div>
                <div class="workflow-stat">
                    <div class="stat-value">2.3s</div>
                    <div class="stat-label">Avg Runtime</div>
                </div>
                <div class="workflow-stat">
                    <div class="stat-value">98.5%</div>
                    <div class="stat-label">Success Rate</div>
                </div>
            </div>

            <div id="alert" class="alert" style="display: none;"></div>

            <!-- Workflow Tabs -->
            <div class="workflow-tabs">
                <button class="workflow-tab active" data-tab="design">
                    <i class="fas fa-project-diagram"></i> Design
                </button>
                <button class="workflow-tab" data-tab="settings">
                    <i class="fas fa-cog"></i> Settings
                </button>
                <button class="workflow-tab" data-tab="executions">
                    <i class="fas fa-history"></i> Executions
                </button>
                <button class="workflow-tab" data-tab="integrations">
                    <i class="fas fa-puzzle-piece"></i> Integrations
                </button>
            </div>

            <!-- Design Tab Content -->
            <div id="design-tab" class="tab-content">
                <!-- Node Palette -->
                <div class="node-palette">
                    <h3 style="margin-bottom: var(--spacing-sm);"><i class="fas fa-toolbox"></i> Node Palette</h3>
                    <p style="color: var(--gray-600); font-size: var(--font-size-sm);">Drag and drop nodes to build your
                        workflow</p>

                    <div class="node-categories">
                        <div class="node-category trigger-nodes">
                            <i class="fas fa-play-circle"></i>
                            <h4>Triggers</h4>
                            <p>Start workflows</p>
                        </div>
                        <div class="node-category action-nodes">
                            <i class="fas fa-bolt"></i>
                            <h4>Actions</h4>
                            <p>Execute tasks</p>
                        </div>
                        <div class="node-category condition-nodes">
                            <i class="fas fa-code-branch"></i>
                            <h4>Conditions</h4>
                            <p>Control flow</p>
                        </div>
                        <div class="node-category data-nodes">
                            <i class="fas fa-database"></i>
                            <h4>Data</h4>
                            <p>Transform data</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h3 class="card-title mb-0">Workflow Designer</h3>
                        <div class="d-flex gap-md">
                            <button class="btn btn-outline btn-sm" id="addNodeBtn">
                                <i class="fas fa-plus"></i> Add Node
                            </button>
                            <button class="btn btn-outline btn-sm" id="undoBtn">
                                <i class="fas fa-undo"></i> Undo
                            </button>
                            <button class="btn btn-outline btn-sm" id="redoBtn">
                                <i class="fas fa-redo"></i> Redo
                            </button>
                            <button class="btn btn-outline btn-sm" id="fullscreenBtn">
                                <i class="fas fa-expand"></i> Fullscreen
                            </button>
                        </div>
                    </div>

                    <div class="builder-container" style="position: relative;">
                        <!-- Minimap -->
                        <div class="minimap">
                            <div style="padding: var(--spacing-sm); text-align: center; color: var(--gray-500);">
                                <i class="fas fa-map"></i>
                                <div style="font-size: var(--font-size-xs);">Minimap</div>
                            </div>
                        </div>

                        <!-- Zoom Controls -->
                        <div class="zoom-controls">
                            <button class="zoom-btn" id="zoomInBtn">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button class="zoom-btn" id="zoomOutBtn">
                                <i class="fas fa-minus"></i>
                            </button>
                            <button class="zoom-btn" id="fitViewBtn">
                                <i class="fas fa-expand-arrows-alt"></i>
                            </button>
                        </div>

                        <div
                            style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-50) 100%); color: var(--gray-500); position: relative;">
                            <div
                                style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-image: radial-gradient(circle, var(--gray-300) 1px, transparent 1px); background-size: 20px 20px; opacity: 0.3;">
                            </div>

                            <div style="position: relative; z-index: 2; text-align: center;">
                                <i class="fas fa-project-diagram"
                                    style="font-size: 4rem; margin-bottom: var(--spacing-lg); color: var(--primary); opacity: 0.7;"></i>
                                <h3 style="color: var(--dark);">Visual Workflow Designer</h3>
                                <p class="mb-lg">Drag nodes from the palette above to start building</p>

                                <div
                                    style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); padding: var(--spacing-xl); border-radius: var(--border-radius-lg); box-shadow: var(--shadow-lg); max-width: 600px; text-align: left; border: 1px solid rgba(255, 255, 255, 0.2);">
                                    <h4 style="color: var(--primary); margin-bottom: var(--spacing-md);">
                                        <i class="fas fa-lightbulb"></i> Getting Started with WorkflowAI Builder
                                    </h4>
                                    <div
                                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--spacing-lg);">
                                        <div>
                                            <h5 style="color: var(--success); margin-bottom: var(--spacing-sm);">
                                                <i class="fas fa-play"></i> 1. Add a Trigger
                                            </h5>
                                            <ul
                                                style="color: var(--gray-700); font-size: var(--font-size-sm); line-height: 1.6;">
                                                <li>Choose from webhooks, schedules, or manual triggers</li>
                                                <li>Configure when your workflow should start</li>
                                            </ul>
                                        </div>
                                        <div>
                                            <h5 style="color: var(--primary); margin-bottom: var(--spacing-sm);">
                                                <i class="fas fa-cogs"></i> 2. Add Actions
                                            </h5>
                                            <ul
                                                style="color: var(--gray-700); font-size: var(--font-size-sm); line-height: 1.6;">
                                                <li>Connect to your favorite Nigerian business tools</li>
                                                <li>Automate tasks like sending emails, updating spreadsheets</li>
                                            </ul>
                                        </div>
                                        <div>
                                            <h5 style="color: var(--warning); margin-bottom: var(--spacing-sm);">
                                                <i class="fas fa-code-branch"></i> 3. Add Logic
                                            </h5>
                                            <ul
                                                style="color: var(--gray-700); font-size: var(--font-size-sm); line-height: 1.6;">
                                                <li>Use conditions to create smart workflows</li>
                                                <li>Handle different scenarios automatically</li>
                                            </ul>
                                        </div>
                                        <div>
                                            <h5 style="color: var(--secondary); margin-bottom: var(--spacing-sm);">
                                                <i class="fas fa-rocket"></i> 4. Test & Deploy
                                            </h5>
                                            <ul
                                                style="color: var(--gray-700); font-size: var(--font-size-sm); line-height: 1.6;">
                                                <li>Test your workflow with sample data</li>
                                                <li>Activate and monitor performance</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-lg"
                                    style="display: flex; gap: var(--spacing-md); flex-wrap: wrap; justify-content: center;">
                                    <button class="btn btn-primary" id="quickStartBtn">
                                        <i class="fas fa-magic"></i> Quick Start Template
                                    </button>
                                    <button class="btn btn-outline" id="importBtn">
                                        <i class="fas fa-upload"></i> Import Workflow
                                    </button>
                                    <button class="btn btn-outline" id="docsBtn">
                                        <i class="fas fa-book"></i> View Documentation
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab Content -->
            <div id="settings-tab" class="tab-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title mb-0">Workflow Settings</h3>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-xl);">
                        <div>
                            <div class="form-group">
                                <label for="workflowName">Workflow Name</label>
                                <input type="text" id="workflowName" class="form-control"
                                    placeholder="Enter workflow name" value="My Automation Workflow">
                            </div>

                            <div class="form-group">
                                <label for="workflowDescription">Description</label>
                                <textarea id="workflowDescription" class="form-control"
                                    placeholder="Describe what this workflow does"
                                    rows="4">This workflow automates customer onboarding by sending welcome emails and creating records in our CRM system.</textarea>
                            </div>

                            <div class="form-group">
                                <label for="workflowStatus">Status</label>
                                <select id="workflowStatus" class="form-control">
                                    <option value="true" selected>Active</option>
                                    <option value="false">Inactive</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="workflowTags">Tags</label>
                                <input type="text" id="workflowTags" class="form-control"
                                    placeholder="e.g. customer, email, crm" value="customer, onboarding, automation">
                            </div>
                        </div>

                        <div>
                            <div class="form-group">
                                <label for="executionTimeout">Execution Timeout (seconds)</label>
                                <input type="number" id="executionTimeout" class="form-control" placeholder="300"
                                    value="300">
                            </div>

                            <div class="form-group">
                                <label for="retryCount">Retry Count</label>
                                <input type="number" id="retryCount" class="form-control" placeholder="3" value="3">
                            </div>

                            <div class="form-group">
                                <label for="errorHandling">Error Handling</label>
                                <select id="errorHandling" class="form-control">
                                    <option value="stop">Stop on Error</option>
                                    <option value="continue" selected>Continue on Error</option>
                                    <option value="retry">Retry on Error</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Notifications</label>
                                <div
                                    style="display: flex; flex-direction: column; gap: var(--spacing-sm); margin-top: var(--spacing-sm);">
                                    <label
                                        style="display: flex; align-items: center; gap: var(--spacing-sm); font-weight: 400;">
                                        <input type="checkbox" checked> Email on Success
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: var(--spacing-sm); font-weight: 400;">
                                        <input type="checkbox" checked> Email on Failure
                                    </label>
                                    <label
                                        style="display: flex; align-items: center; gap: var(--spacing-sm); font-weight: 400;">
                                        <input type="checkbox"> SMS Notifications
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Executions Tab Content -->
            <div id="executions-tab" class="tab-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title mb-0">Execution History</h3>
                        <button class="btn btn-outline btn-sm">
                            <i class="fas fa-refresh"></i> Refresh
                        </button>
                    </div>

                    <div class="execution-logs">
                        <div class="log-entry">
                            <span class="log-timestamp">2023-12-08 14:32:15</span>
                            <i class="fas fa-check-circle log-success"></i>
                            <span>Workflow execution completed successfully (Duration: 2.3s)</span>
                        </div>
                        <div class="log-entry">
                            <span class="log-timestamp">2023-12-08 14:30:42</span>
                            <i class="fas fa-play log-success"></i>
                            <span>Workflow triggered by webhook from contact form</span>
                        </div>
                        <div class="log-entry">
                            <span class="log-timestamp">2023-12-08 14:12:18</span>
                            <i class="fas fa-exclamation-triangle log-warning"></i>
                            <span>Email service temporarily unavailable, retrying...</span>
                        </div>
                        <div class="log-entry">
                            <span class="log-timestamp">2023-12-08 14:12:25</span>
                            <i class="fas fa-check-circle log-success"></i>
                            <span>Retry successful, email sent to customer@example.com</span>
                        </div>
                        <div class="log-entry">
                            <span class="log-timestamp">2023-12-08 13:45:33</span>
                            <i class="fas fa-times-circle log-error"></i>
                            <span>CRM API connection failed - Invalid API key</span>
                        </div>
                        <div class="log-entry">
                            <span class="log-timestamp">2023-12-08 13:22:11</span>
                            <i class="fas fa-check-circle log-success"></i>
                            <span>Manual execution completed by user@workflowai.com</span>
                        </div>
                    </div>

                    <div class="mt-lg">
                        <h4>Recent Performance</h4>
                        <div class="workflow-stats">
                            <div class="workflow-stat">
                                <div class="stat-value">47</div>
                                <div class="stat-label">Today's Runs</div>
                            </div>
                            <div class="workflow-stat">
                                <div class="stat-value">94.2%</div>
                                <div class="stat-label">Success Rate</div>
                            </div>
                            <div class="workflow-stat">
                                <div class="stat-value">1.8s</div>
                                <div class="stat-label">Avg Duration</div>
                            </div>
                            <div class="workflow-stat">
                                <div class="stat-value">â‚¦2,340</div>
                                <div class="stat-label">Cost Saved</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Integrations Tab Content -->
            <div id="integrations-tab" class="tab-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title mb-0">Available Integrations</h3>
                        <p style="color: var(--gray-600); margin: 0;">Connect your favorite Nigerian business tools</p>
                    </div>

                    <div
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--spacing-lg);">
                        <div>
                            <h4 style="color: var(--primary); margin-bottom: var(--spacing-md);">
                                <i class="fas fa-envelope"></i> Email & Communication
                            </h4>
                            <div class="integration-grid">
                                <div class="integration-card">
                                    <div
                                        style="width: 32px; height: 32px; background: #4285f4; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                        <i class="fas fa-envelope" style="color: white;"></i>
                                    </div>
                                    <span>Gmail</span>
                                </div>
                                <div class="integration-card">
                                    <div
                                        style="width: 32px; height: 32px; background: #0078d4; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                        <i class="fas fa-envelope" style="color: white;"></i>
                                    </div>
                                    <span>Outlook</span>
                                </div>
                                <div class="integration-card">
                                    <div
                                        style="width: 32px; height: 32px; background: #00d9ff; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                        <i class="fas fa-comment" style="color: white;"></i>
                                    </div>
                                    <span>Slack</span>
                                </div>
                                <div class="integration-card">
                                    <div
                                        style="width: 32px; height: 32px; background: #25d366; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                        <i class="fab fa-whatsapp" style="color: white;"></i>
                                    </div>
                                    <span>WhatsApp</span>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h4 style="color: var(--success); margin-bottom: var(--spacing-md);">
                                <i class="fas fa-chart-bar"></i> Business Analytics
                            </h4>
                            <div class="integration-grid">
                                <div class="integration-card">
                                    <div
                                        style="width: 32px; height: 32px; background: #0f9d58; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                        <i class="fas fa-table" style="color: white;"></i>
                                    </div>
                                    <span>Google Sheets</span>
                                </div>
                                <div class="integration-card">
                                    <div
                                        style="width: 32px; height: 32px; background: #217346; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                        <i class="fas fa-file-excel" style="color: white;"></i>
                                    </div>
                                    <span>Excel</span>
                                </div>
                                <div
                                    style="width: 32px; height: 32px; background: #ff6900; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-chart-line" style="color: white;"></i>
                                </div>
                                <span>Analytics</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #1f77b4; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-database" style="color: white;"></i>
                                </div>
                                <span>Power BI</span>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 style="color: var(--warning); margin-bottom: var(--spacing-md);">
                            <i class="fas fa-credit-card"></i> Nigerian Payment Systems
                        </h4>
                        <div class="integration-grid">
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #00c3f7; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-credit-card" style="color: white;"></i>
                                </div>
                                <span>Paystack</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #0b2c8a; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-university" style="color: white;"></i>
                                </div>
                                <span>Flutterwave</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #0066cc; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-mobile-alt" style="color: white;"></i>
                                </div>
                                <span>Interswitch</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #ff6b35; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-coins" style="color: white;"></i>
                                </div>
                                <span>Kuda Bank</span>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 style="color: var(--secondary); margin-bottom: var(--spacing-md);">
                            <i class="fas fa-users"></i> CRM & Sales
                        </h4>
                        <div class="integration-grid">
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #ff7a00; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-hubspot" style="color: white;"></i>
                                </div>
                                <span>HubSpot</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #1589ee; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-cloud" style="color: white;"></i>
                                </div>
                                <span>Salesforce</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #00a82b; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-users" style="color: white;"></i>
                                </div>
                                <span>Zoho CRM</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #663399; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-address-book" style="color: white;"></i>
                                </div>
                                <span>Pipedrive</span>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 style="color: var(--accent); margin-bottom: var(--spacing-md);">
                            <i class="fas fa-store"></i> E-commerce
                        </h4>
                        <div class="integration-grid">
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #95bf47; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fab fa-shopify" style="color: white;"></i>
                                </div>
                                <span>Shopify</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #96588a; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fab fa-wordpress" style="color: white;"></i>
                                </div>
                                <span>WooCommerce</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #ff9900; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fab fa-amazon" style="color: white;"></i>
                                </div>
                                <span>Amazon</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #00b4d8; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-shopping-cart" style="color: white;"></i>
                                </div>
                                <span>Jumia</span>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 style="color: var(--danger); margin-bottom: var(--spacing-md);">
                            <i class="fas fa-cloud"></i> Cloud Storage
                        </h4>
                        <div class="integration-grid">
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #4285f4; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fab fa-google-drive" style="color: white;"></i>
                                </div>
                                <span>Google Drive</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #007ee5; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fab fa-dropbox" style="color: white;"></i>
                                </div>
                                <span>Dropbox</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #0078d4; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fab fa-microsoft" style="color: white;"></i>
                                </div>
                                <span>OneDrive</span>
                            </div>
                            <div class="integration-card">
                                <div
                                    style="width: 32px; height: 32px; background: #ff7b00; border-radius: 4px; display: flex; align-items: center; justify-content: center; margin: 0 auto var(--spacing-sm);">
                                    <i class="fas fa-box" style="color: white;"></i>
                                </div>
                                <span>Box</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-xl"
                    style="text-align: center; padding: var(--spacing-xl); background: var(--gray-50); border-radius: var(--border-radius-lg);">
                    <i class="fas fa-plus-circle"
                        style="font-size: var(--font-size-4xl); color: var(--primary); margin-bottom: var(--spacing-md);"></i>
                    <h4 style="margin-bottom: var(--spacing-sm);">Need More Integrations?</h4>
                    <p style="color: var(--gray-600); margin-bottom: var(--spacing-lg);">Can't find the tool you need?
                        We're constantly adding new integrations for Nigerian businesses.</p>
                    <button class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i> Request Integration
                    </button>
                </div>
            </div>
        </div>

        <!-- Workflow Configuration Card -->
        <div class="card mt-lg">
            <div class="card-header">
                <h3 class="card-title mb-0">n8n Workflow Configuration</h3>
            </div>
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h4 style="color: var(--primary); margin-bottom: var(--spacing-sm);">
                        <i class="fas fa-link"></i> Connected Workflow
                    </h4>
                    <p class="mb-0" style="color: var(--gray-600);">
                        This workflow is synchronized with n8n workflow:
                        <code id="n8nWorkflowId"
                            style="background: var(--gray-100); padding: var(--spacing-xs) var(--spacing-sm); border-radius: var(--border-radius-sm); color: var(--primary); font-weight: 600;">n8n_workflow_12345</code>
                    </p>
                    <div class="mt-sm">
                        <span class="badge badge-success">
                            <i class="fas fa-check"></i> Connected
                        </span>
                        <span class="badge badge-outline badge-primary" style="margin-left: var(--spacing-sm);">
                            <i class="fas fa-sync"></i> Auto-sync Enabled
                        </span>
                    </div>
                </div>
                <div class="d-flex gap-md">
                    <button class="btn btn-outline">
                        <i class="fas fa-sync"></i> Sync Changes
                    </button>
                    <button class="btn btn-outline">
                        <i class="fas fa-external-link-alt"></i> Open in n8n
                    </button>
                </div>
            </div>
        </div>
        </div>
    </section>

    <!-- n8n Iframe Container -->
    <div id="n8nContainer" class="n8n-container">
        <div class="n8n-toolbar">
            <div>
                <button id="closeN8N" class="btn btn-sm btn-outline-secondary">
                    <i class="fas fa-arrow-left"></i> Back to Builder
                </button>
                <span id="n8nWorkflowTitle" style="margin-left: 15px; font-weight: 500;">n8n Workflow Editor</span>
            </div>
            <div>
                <button id="saveN8NWorkflow" class="btn btn-sm btn-primary">
                    <i class="fas fa-save"></i> Save Workflow
                </button>
            </div>
        </div>
        <div class="n8n-iframe-container">
            <div id="n8nLoading" class="n8n-loading">
                <div class="text-center">
                    <div class="spinner-border text-primary" role="status">
                        <span class="sr-only">Loading n8n Editor...</span>
                    </div>
                    <p class="mt-2">Loading n8n Workflow Editor...</p>
                </div>
            </div>
            <iframe id="n8nIframe" class="n8n-iframe" src="" frameborder="0"></iframe>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3><i class="fas fa-robot"></i> WorkflowAI</h3>
                    <p>Empowering Nigerian SMEs and entrepreneurs with intelligent workflow automation since 2023.
                        Build, deploy, and scale your business processes with ease.</p>
                    <div style="margin-top: var(--spacing-lg);">
                        <span class="badge badge-primary">ðŸ‡³ðŸ‡¬ Made in Nigeria</span>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Product</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-magic"></i> Features</a></li>
                        <li><a href="#"><i class="fas fa-th-large"></i> Templates</a></li>
                        <li><a href="#"><i class="fas fa-puzzle-piece"></i> Integrations</a></li>
                        <li><a href="#"><i class="fas fa-tags"></i> Pricing</a></li>
                        <li><a href="#"><i class="fas fa-shield-alt"></i> Security</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-book"></i> Documentation</a></li>
                        <li><a href="#"><i class="fas fa-graduation-cap"></i> Tutorials</a></li>
                        <li><a href="#"><i class="fas fa-blog"></i> Blog</a></li>
                        <li><a href="#"><i class="fas fa-headset"></i> Support</a></li>
                        <li><a href="#"><i class="fas fa-users"></i> Community</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Company</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-info-circle"></i> About Us</a></li>
                        <li><a href="#"><i class="fas fa-envelope"></i> Contact</a></li>
                        <li><a href="#"><i class="fas fa-briefcase"></i> Careers</a></li>
                        <li><a href="#"><i class="fas fa-shield-alt"></i> Privacy Policy</a></li>
                        <li><a href="#"><i class="fas fa-balance-scale"></i> Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 WorkflowAI. All rights reserved. Built with â¤ï¸ for Nigerian businesses.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script src="assets/builder.js"></script>
    <script src="assets/templates.js"></script>

    <!-- n8n Integration Script -->
    <script>
        // Make sure CONFIG is available
        document.addEventListener('DOMContentLoaded', function() {
            const n8nContainer = document.getElementById('n8nContainer');
            const n8nIframe = document.getElementById('n8nIframe');
            const n8nLoading = document.getElementById('n8nLoading');
            const closeN8N = document.getElementById('closeN8N');
            const saveN8NWorkflow = document.getElementById('saveN8NWorkflow');
            const n8nWorkflowTitle = document.getElementById('n8nWorkflowTitle');
            
            // Current workflow ID
            let currentWorkflowId = null;
            
            // Function to open n8n editor
            function openN8NEditor(workflowId, workflowName = '') {
                console.log('Opening n8n editor for workflow:', workflowId, workflowName);
                currentWorkflowId = workflowId;
                n8nWorkflowTitle.textContent = `n8n Editor - ${workflowName || 'New Workflow'}`;
                
                // Show loading state
                n8nLoading.style.display = 'flex';
                n8nContainer.style.display = 'flex';
                document.body.classList.add('n8n-open');
                
                // Load n8n in iframe
                const n8nUrl = `${CONFIG.N8N_BASE_URL}/workflow?workflowId=${workflowId}`;
                console.log('Loading n8n URL:', n8nUrl);
                
                // Reset iframe source to force reload
                n8nIframe.src = '';
                setTimeout(() => {
                    n8nIframe.src = n8nUrl;
                }, 100);
                
                // Handle iframe load event
                n8nIframe.onload = function() {
                    console.log('n8n iframe loaded');
                    n8nLoading.style.display = 'none';
                };
                
                // Handle iframe errors
                n8nIframe.onerror = function() {
                    console.error('Failed to load n8n iframe');
                    n8nLoading.innerHTML = `
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle"></i>
                            Failed to load n8n editor. Please check if the n8n server is running at ${CONFIG.N8N_BASE_URL}
                            <div style="margin-top: 10px;">
                                <p>Make sure:</p>
                                <ol>
                                    <li>The n8n Docker container is running</li>
                                    <li>Port 5678 is accessible</li>
                                    <li>There are no CORS issues (check browser console)</li>
                                </ol>
                            </div>
                        </div>
                        <button class="btn btn-primary mt-3" onclick="window.location.reload()">
                            <i class="fas fa-sync"></i> Try Again
                        </button>
                    `;
                };
            }
            
            // Close n8n editor
            closeN8N.addEventListener('click', function() {
                n8nContainer.style.display = 'none';
                document.body.classList.remove('n8n-open');
                // Don't unset the iframe src to preserve state if reopened
            });
            
            // Save workflow from n8n editor
            saveN8NWorkflow.addEventListener('click', async function() {
                const originalButtonText = saveN8NWorkflow.innerHTML;
                saveN8NWorkflow.disabled = true;
                saveN8NWorkflow.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
                
                try {
                    // In a real implementation, you would save the workflow data here
                    console.log('Saving workflow:', currentWorkflowId);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    showAlert('Workflow saved successfully!', 'success');
                    
                    // Close the n8n editor after saving
                    n8nContainer.style.display = 'none';
                    n8nIframe.src = '';
                } catch (error) {
                    console.error('Error saving workflow:', error);
                    showAlert('Failed to save workflow. Please try again.', 'error');
                } finally {
                    saveN8NWorkflow.disabled = false;
                    saveN8NWorkflow.innerHTML = originalButtonText;
                }
            });
            
            // Function to show alert
            function showAlert(message, type = 'info') {
                console.log(`${type}: ${message}`);
                // This is a simplified alert function
                alert(`${type.toUpperCase()}: ${message}`);
            }
            
            // Expose the openN8NEditor function globally
            window.openN8NEditor = openN8NEditor;
            
            console.log('n8n integration script loaded');
        });
    </script>
</body>

</html>